version: "1.0.0"

chunking:
  strategy: by_title
  max_characters: 1500
  overlap: 200
  provider: unstructured

retrieval:
  top_k: 20
  dedup_threshold: 0.95
  rerank_provider: cohere
  rerank_top_n: 5

compression:
  method: bm25_subscoring
  sentences_per_chunk: 5
  max_total_tokens: 4000

routing:
  provider: semantic_router
  embedding_model: all-MiniLM-L6-v2
  embedding_provider: local
  default_route: rag_knowledge_base
  confidence_threshold: 0.15

query_expansion:
  enabled: true
  method: multi_query
  num_queries: 3
  model: anthropic/claude-haiku-4-5

safety:
  injection_detection:
    layer_1: guardrails_ai
    layer_2: lakera_guard
    layer_3_enabled: false
  pii_detection: true
  pii_action: redact

generation:
  provider: openrouter
  base_url: https://openrouter.ai/api/v1
  model: anthropic/claude-sonnet-4-5
  temperature: 0.1
  max_output_tokens: 1000
  fallback_model: anthropic/claude-haiku-4-5

hallucination:
  model: vectara/hallucination_evaluation_model
  threshold_pass: 0.85
  threshold_warn: 0.70
  fallback_on_fail: true
  aggregation_method: max

observability:
  langfuse_enabled: true
  langfuse_sample_rate: 1.0
  export_to_s3: true
  export_schedule: daily

experimentation:
  shadow_mode:
    enabled: false
    candidate_model: null
    candidate_prompt_path: null
    sample_rate: 0.1
    budget_limit_usd: 10.0
    circuit_breaker_latency_multiplier: 3.0
  feature_flags:
    enabled: false
    config_path: experiment_configs/flags.yaml
    default_variant: control

compliance:
  deletion_sla_hours: 72
  audit_log_immutable: true
  audit_log_path: audit_logs/local
  retention:
    vectors_days: 365
    traces_days: 90
    audit_logs_days: 2555
    feedback_days: 365
